# 分析ドメインテストパラメータと期待結果

本ドキュメントでは、テスト仕様書で定義されたテストケースのための入力パラメータと期待される結果を詳細に記述します。

## 1. 単体テスト

### 1.1 エンティティテスト

#### 1.1.1 AwakeningLevelEntityテスト

| テストケース | 入力パラメータ | 期待される結果 |
|------------|--------------|-------------|
| 有効な数値でのインスタンス生成 | `level: 50` | インスタンスが正常に生成される |
| 有効な最小値でのインスタンス生成 | `level: 0` | インスタンスが正常に生成される |
| 有効な最大値でのインスタンス生成 | `level: 100` | インスタンスが正常に生成される |
| 範囲外の小さい値 | `level: -1` | `InvalidLevelException`が発生する |
| 範囲外の大きい値 | `level: 101` | `InvalidLevelException`が発生する |
| レベル分類テスト（初級） | `level: 25` | `getLevelCategory()`が`"初級"`を返す |
| レベル分類テスト（中級） | `level: 65` | `getLevelCategory()`が`"中級"`を返す |
| レベル分類テスト（上級） | `level: 85` | `getLevelCategory()`が`"上級"`を返す |
| レベル分類テスト（閾値） | `level: 50` | `getLevelCategory()`が`"中級"`を返す |

#### 1.1.2 InsightEntityテスト

| テストケース | 入力パラメータ | 期待される結果 |
|------------|--------------|-------------|
| 必須フィールドでのインスタンス生成 | `content: "テストインサイト内容", type: InsightType.PATTERN, generatedAt: 2023-05-03T12:00:00Z` | インスタンスが正常に生成される |
| 任意フィールドを含むインスタンス生成 | `content: "テストインサイト内容", type: InsightType.GROWTH, generatedAt: 2023-05-03T12:00:00Z, contextData: {"source": "投稿A"}` | インスタンスが正常に生成され、`contextData`が正しく設定される |
| コンテンツなしのインスタンス生成 | `content: "", type: InsightType.PATTERN, generatedAt: 2023-05-03T12:00:00Z` | `InvalidInsightException`が発生する |
| 有効期限チェック（有効） | インサイト作成時間: 現在時刻から5日前 | `isExpired()`が`false`を返す |
| 有効期限チェック（期限切れ） | インサイト作成時間: 現在時刻から31日前 | `isExpired()`が`true`を返す |
| コンテキスト情報の設定と取得 | `contextData: {"activity": "瞑想", "duration": "15分"}` | `getContextData("activity")`が`"瞑想"`を返す |

#### 1.1.3 NextActionEntityテスト

| テストケース | 入力パラメータ | 期待される結果 |
|------------|--------------|-------------|
| アプリ内アクション生成 | `title: "投稿をシェア", description: "興味深い投稿を友人と共有しましょう", type: ActionType.IN_APP, deadline: 2023-05-10T23:59:59Z` | インスタンスが正常に生成される |
| 実生活アクション生成 | `title: "15分の瞑想", description: "朝の時間に短い瞑想を取り入れましょう", type: ActionType.REAL_LIFE, deadline: 2023-05-10T23:59:59Z` | インスタンスが正常に生成される |
| 完了ステータス更新 | `action.complete()` | `isCompleted()`が`true`を返す |
| 完了ステータスのリセット | `action.resetCompletion()` | `isCompleted()`が`false`を返す |
| 期限切れチェック（期限内） | 期限: 現在時刻から3日後 | `isOverdue()`が`false`を返す |
| 期限切れチェック（期限超過） | 期限: 現在時刻から3日前 | `isOverdue()`が`true`を返す |
| 難易度設定 | `difficulty: ActionDifficulty.MEDIUM` | `getDifficulty()`が`ActionDifficulty.MEDIUM`を返す |

### 1.2 ユースケーステスト

#### 1.2.1 GetAwakeningLevelUseCaseテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| 有効なユーザーIDでの取得 | `userId: "user123"` | リポジトリが`AwakeningLevelEntity(level: 65)`を返す | `Right(AwakeningLevelEntity(level: 65))`が返される |
| 存在しないユーザーID | `userId: "invalid_user"` | リポジトリが`UserNotFoundException`を返す | `Left(UserNotFoundFailure())`が返される |
| ネットワークエラー | `userId: "user123"` | リポジトリが`NetworkException`を返す | `Left(NetworkFailure())`が返される |
| サーバーエラー | `userId: "user123"` | リポジトリが`ServerException`を返す | `Left(ServerFailure())`が返される |
| リポジトリの呼び出し確認 | `userId: "user123"` | - | リポジトリの`getAwakeningLevel("user123")`が1回呼び出される |

#### 1.2.2 GenerateInsightsUseCaseテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| 十分なアクティビティデータでの生成 | `userId: "user123", limit: 3` | アクティビティリポジトリが十分なデータを返す | 3件のインサイトが返される、内容が肯定的で建設的である |
| 不十分なアクティビティデータ | `userId: "new_user", limit: 3` | アクティビティリポジトリがデータ不足を返す | 汎用的なインサイトが返される |
| アクティビティタイプフィルタリング | `userId: "user123", activityTypes: [ActivityType.POST, ActivityType.COMMENT]` | アクティビティリポジトリが指定タイプのデータを返す | 返されるインサイトがPOSTとCOMMENTアクティビティに関連する |
| 時間範囲フィルタリング | `userId: "user123", startDate: 2023-04-01, endDate: 2023-04-30` | アクティビティリポジトリが指定期間のデータを返す | 返されるインサイトが指定期間のアクティビティに関連する |
| インサイト種類フィルタリング | `userId: "user123", insightTypes: [InsightType.PATTERN]` | - | 返されるインサイトの種類がすべてPATTERNである |
| ネットワークエラー | `userId: "user123"` | アクティビティリポジトリが`NetworkException`を返す | `Left(NetworkFailure())`が返される |

#### 1.2.3 SuggestNextActionsUseCaseテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| 初級レベルユーザー向け提案 | `userId: "beginner_user", limit: 3` | 目醒め度リポジトリが`AwakeningLevelEntity(level: 25)`を返す | 返されるアクションがすべて初級レベルに適したものである |
| 中級レベルユーザー向け提案 | `userId: "intermediate_user", limit: 3` | 目醒め度リポジトリが`AwakeningLevelEntity(level: 65)`を返す | 返されるアクションがすべて中級レベルに適したものである |
| 上級レベルユーザー向け提案 | `userId: "advanced_user", limit: 3` | 目醒め度リポジトリが`AwakeningLevelEntity(level: 85)`を返す | 返されるアクションがすべて上級レベルに適したものである |
| 過去の完了アクション考慮 | `userId: "user123", limit: 3` | 完了済アクションリスト含むリポジトリ設定 | 返されるアクションが過去に完了したものと重複しない |
| アクションタイプフィルタリング | `userId: "user123", actionTypes: [ActionType.IN_APP]` | - | 返されるアクションがすべてIN_APP種類である |
| アクション難易度フィルタリング | `userId: "user123", difficulties: [ActionDifficulty.EASY, ActionDifficulty.MEDIUM]` | - | 返されるアクションの難易度がすべてEASYかMEDIUMである |
| アクション多様性確保 | `userId: "user123", limit: 5` | - | 5件のアクションが複数のタイプと難易度を含む |

#### 1.2.4 RecommendPersonalizedContentUseCaseテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| ユーザーの興味に基づく推奨 | `userId: "user123", limit: 5` | ユーザープロファイルリポジトリが特定の興味を返す | 返されるコンテンツがユーザーの興味に関連している |
| 成長に有益なコンテンツ推奨 | `userId: "user123", includeGrowthContent: true` | - | 返されるコンテンツに新たな視点を含むものが含まれる |
| コンテンツタイプフィルタリング | `userId: "user123", contentTypes: [ContentType.AUDIO, ContentType.VIDEO]` | - | 返されるコンテンツがすべてAUDIOかVIDEO種類である |
| 推奨理由の説明確認 | `userId: "user123", includeReasons: true` | - | 各コンテンツが`recommendationReason`フィールドを含む |
| 既読コンテンツの除外 | `userId: "user123", excludeViewed: true` | 既読コンテンツリスト含むリポジトリ設定 | 返されるコンテンツが過去に閲覧したものを含まない |
| コールドスタートユーザー | `userId: "new_user"` | ユーザープロファイルが最小限の情報を返す | 一般的に人気の高いコンテンツが返される |

### 1.3 リポジトリテスト

#### 1.3.1 AnalysisRepositoryImplテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| 目醒め度データの正常取得 | `userId: "user123"` | リモートデータソースが有効なレスポンスを返す | `Right(AwakeningLevelEntity(level: 65))`が返される |
| インサイトデータの正常取得 | `userId: "user123"` | リモートデータソースが有効なレスポンスを返す | `Right(List<InsightEntity>)`が返される |
| ネットワークエラー処理 | `userId: "user123"` | リモートデータソースが`NetworkException`を返す | `Left(NetworkFailure())`が返される |
| サーバーエラー処理 | `userId: "user123"` | リモートデータソースが`ServerException`を返す | `Left(ServerFailure())`が返される |
| キャッシュ機能テスト | 1回目: `getAwakeningLevel("user123")`, 2回目: `getAwakeningLevel("user123")` | - | リモートデータソースへの呼び出しが1回のみ発生する |
| モデル変換テスト | `userId: "user123"` | リモートデータソースが`AwakeningLevelModel`を返す | 正しく`AwakeningLevelEntity`に変換される |

#### 1.3.2 UserActivityRepositoryImplテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| アクティビティデータの正常取得 | `userId: "user123"` | リモート・ローカルデータソースが有効なレスポンスを返す | `Right(List<ActivityEntity>)`が返される |
| 時間範囲フィルタリング | `userId: "user123", startDate: 2023-04-01, endDate: 2023-04-30` | - | 指定期間内のアクティビティのみが返される |
| アクティビティタイプフィルタリング | `userId: "user123", types: [ActivityType.POST]` | - | 指定タイプのアクティビティのみが返される |
| ローカルデータの優先使用 | `userId: "user123"` | ローカルデータソースが有効なデータを返す | リモートデータソースへの呼び出しが発生しない |
| ローカルデータなしの場合のリモート取得 | `userId: "user123"` | ローカルデータソースが空を返す | リモートデータソースから取得が行われる |
| リモートデータのローカル保存 | `userId: "user123"` | リモートデータソースが有効なデータを返す | ローカルデータソースの`saveActivities`が呼ばれる |

### 1.4 データソーステスト

#### 1.4.1 AnalysisRemoteDataSourceテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| 目醒め度APIリクエスト | `userId: "user123"` | HTTPクライアントが200レスポンスを返す | `AwakeningLevelModel`が返される |
| インサイトAPIリクエスト | `userId: "user123", limit: 5` | HTTPクライアントが200レスポンスを返す | `List<InsightModel>`が5件返される |
| アクションAPIリクエスト | `userId: "user123", limit: 3` | HTTPクライアントが200レスポンスを返す | `List<NextActionModel>`が3件返される |
| HTTPエラー処理 (4xx) | `userId: "invalid_user"` | HTTPクライアントが404レスポンスを返す | `UserNotFoundException`が発生する |
| HTTPエラー処理 (5xx) | `userId: "user123"` | HTTPクライアントが500レスポンスを返す | `ServerException`が発生する |
| ネットワークエラー処理 | `userId: "user123"` | HTTPクライアントがネットワークエラーを返す | `NetworkException`が発生する |
| リクエストパラメータ検証 | `userId: "user123", insightTypes: [InsightType.PATTERN]` | - | リクエストURLに`insightTypes=PATTERN`が含まれる |

#### 1.4.2 UserActivityLocalDataSourceテスト

| テストケース | 入力パラメータ | モック設定 | 期待される結果 |
|------------|--------------|----------|-------------|
| アクティビティデータ取得 | `userId: "user123"` | DBが有効なデータを返す | `List<ActivityModel>`が返される |
| アクティビティデータ保存 | `activities: List<ActivityModel>` | - | DBの`insertActivities`メソッドが呼ばれる |
| 時間範囲クエリ | `userId: "user123", startDate: 2023-04-01, endDate: 2023-04-30` | - | SQLクエリに適切な時間範囲条件が含まれる |
| タイプフィルタクエリ | `userId: "user123", types: [ActivityType.POST]` | - | SQLクエリに適切なタイプ条件が含まれる |
| データベースエラー処理 | `userId: "user123"` | DBが例外を投げる | `DatabaseException`が発生する |
| データ削除処理 | `userId: "user123", olderThan: 2023-01-01` | - | 指定日付より古いデータが削除される |

## 2. 統合テスト

### 2.1 リポジトリ統合テスト

| テストケース | 入力パラメータ | テスト環境設定 | 期待される結果 |
|------------|--------------|------------|-------------|
| 実APIエンドポイント通信 | `userId: "test_user"` | テスト用APIサーバー稼働 | 有効な分析データが返される |
| 実データベース操作 | `activities: List<ActivityModel>` | テスト用DB設定 | データが正しく保存・取得される |
| 認証トークン付きリクエスト | `userId: "test_user", token: "valid_token"` | 認証要求APIサーバー | 認証済みリクエストが成功する |
| 認証トークン無効時 | `userId: "test_user", token: "invalid_token"` | 認証要求APIサーバー | `AuthenticationFailure`が返される |
| ネットワークタイムアウト | `userId: "test_user"` | 高レイテンシネットワーク設定 | タイムアウト後に`NetworkFailure`が返される |
| キャッシュ有効期限テスト | 1回目: 取得, 待機(6分), 2回目: 取得 | キャッシュ有効期限5分設定 | 2回目の取得で新たなAPIリクエストが発生する |

### 2.2 ユースケース統合テスト

| テストケース | 入力パラメータ | テスト環境設定 | 期待される結果 |
|------------|--------------|------------|-------------|
| 目醒め度取得〜インサイト生成フロー | `userId: "test_user"` | 実リポジトリ実装使用 | 目醒め度に応じたインサイトが生成される |
| インサイト生成〜アクション提案フロー | `userId: "test_user"` | 実リポジトリ実装使用 | インサイトに関連したアクションが提案される |
| 複数リポジトリ使用（アクティビティ+プロファイル） | `userId: "test_user"` | 実リポジトリ実装使用 | 両方のデータが正しく統合されて結果に反映される |
| DIコンテナを使用した依存関係解決 | `userId: "test_user"` | 本番同様のDI設定 | 正しいインスタンスが注入され、機能が正常に動作する |
| エラー伝播フロー | `userId: "invalid_user"` | エラー発生設定 | エラーが適切に上位層に伝播される |

### 2.3 バックエンドAPI統合テスト

| テストケース | APIエンドポイント | リクエストパラメータ | 期待される結果 |
|------------|-----------------|------------------|-------------|
| 目醒め度取得API | `GET /api/analysis/awakening-level` | `userId: "test_user"` | 200 OK, 有効なJSONレスポンス |
| インサイト取得API | `GET /api/analysis/insights` | `userId: "test_user", limit: 5` | 200 OK, 5件のインサイトを含むJSONレスポンス |
| 次のステップ提案API | `GET /api/analysis/next-actions` | `userId: "test_user", limit: 3` | 200 OK, 3件のアクションを含むJSONレスポンス |
| パーソナライズドコンテンツAPI | `GET /api/analysis/recommended-content` | `userId: "test_user", limit: 5` | 200 OK, 5件のコンテンツを含むJSONレスポンス |
| 認証ヘッダー検証 | `GET /api/analysis/awakening-level` | `Authorization: Bearer invalid_token` | 401 Unauthorized |
| レート制限テスト | `GET /api/analysis/insights` (連続10回) | `userId: "test_user"` | 10回目のリクエストで429 Too Many Requests |
| アクション完了報告API | `POST /api/analysis/next-actions/complete` | `actionId: "action123"` | 200 OK, 成功レスポンス |
| インサイトフィードバックAPI | `POST /api/analysis/insights/feedback` | `insightId: "insight123", helpful: true` | 200 OK, 成功レスポンス |

## 3. UIテスト

### 3.1 分析画面UI要素テスト

| テストケース | 画面状態 | 期待される結果 |
|------------|--------|-------------|
| 目醒め度表示レンダリング | 目醒め度: 65 | 目醒め度グラフが65%まで塗りつぶされている |
| インサイトカードレンダリング | インサイト3件設定 | 3件のインサイトカードが表示されている |
| 次のステップ提案レンダリング | アクション3件設定 | 3件のアクションカードが表示されている |
| ローディング状態レンダリング | データ取得中 | プログレスインジケーターが表示されている |
| エラー状態レンダリング | データ取得エラー | エラーメッセージとリトライボタンが表示されている |
| スマートフォン画面サイズ | 画面幅: 375px | UI要素が適切に縦長レイアウトに調整される |
| タブレット画面サイズ | 画面幅: 768px | UI要素が2カラムレイアウトに調整される |
| スクリーンリーダーテスト | - | すべてのUI要素に適切なアクセシビリティラベルが設定されている |
| コントラスト比テスト | - | すべてのテキスト要素がWCAG基準のコントラスト比を満たしている |

### 3.2 ユーザーインタラクションテスト

| テストケース | ユーザー操作 | 期待される結果 |
|------------|-----------|-------------|
| インサイトカードタップ | インサイトカードをタップ | インサイト詳細画面が表示される |
| アクション完了マーキング | アクション完了チェックボックスをタップ | チェックマークが表示され、完了状態になる |
| インサイトシェア操作 | インサイトシェアボタンをタップ | シェアオプションが表示される |
| パーソナライズドコンテンツナビゲーション | 「おすすめコンテンツを見る」ボタンをタップ | コンテンツ一覧画面に遷移する |
| インサイトフィードバック操作 | 「役立った」/「役立たなかった」ボタンをタップ | フィードバックが送信され、UIが更新される |
| 画面プル更新操作 | 画面を下から上へスワイプ | データが再取得され、UI更新される |
| 目醒め度詳細表示 | 目醒め度グラフをタップ | 目醒め度の詳細説明が表示される |
| フィルター操作 | フィルターボタンをタップしオプション選択 | 選択に応じたフィルター済みデータが表示される |

### 3.3 ビジュアル回帰テスト

| テストケース | 画面/テーマ設定 | 期待される結果 |
|------------|-------------|-------------|
| 分析画面基本レイアウト | 標準データ、ライトモード | スクリーンショットが基準画像と一致する |
| ダークモード表示 | 標準データ、ダークモード | スクリーンショットが基準画像と一致する |
| インサイト詳細画面 | インサイト詳細データ、ライトモード | スクリーンショットが基準画像と一致する |
| アクション詳細画面 | アクション詳細データ、ライトモード | スクリーンショットが基準画像と一致する |
| 異なるデバイスサイズ | スマートフォン/タブレット/デスクトップ | 各デバイスでのスクリーンショットが基準画像と一致する |
| カスタムテーマ適用 | カスタムテーマ設定 | カスタムカラー設定が正しく適用されている |
| トランジションアニメーション | 画面遷移時 | アニメーションが滑らかで一貫性がある |
| 多言語表示 | 言語設定: 英語/日本語 | 各言語でのレイアウトが適切に調整されている |

## 4. パフォーマンステスト

### 4.1 レスポンス時間テスト

| テストケース | テスト条件 | 期待される結果 |
|------------|----------|-------------|
| 目醒め度データ取得時間 | 標準ネットワーク条件 | 2秒以内に完了する |
| インサイト生成時間 | 標準ネットワーク条件 | 3秒以内に完了する |
| コンテンツ推奨時間 | 標準ネットワーク条件 | 2秒以内に完了する |
| 高速ネットワーク環境 | 帯域幅: 50Mbps, レイテンシ: 20ms | すべての処理が1秒以内に完了する |
| 低速ネットワーク環境 | 帯域幅: 2Mbps, レイテンシ: 300ms | タイムアウトなく処理が完了する |
| 不安定ネットワーク環境 | パケットロス: 5% | 自動リトライで処理が完了する |
| オフライン環境 | ネットワーク接続なし | キャッシュデータが表示され、オフライン通知が表示される |
| 大量データ処理 | 過去1年分のアクティビティデータ | 処理時間が許容範囲内である |

### 4.2 メモリ使用量テスト

| テストケース | テスト条件 | 期待される結果 |
|------------|----------|-------------|
| 初期メモリ使用量 | アプリ起動直後 | ベースライン使用量が30MB以下 |
| 長時間使用時メモリ | 30分間連続使用 | メモリ使用量が安定していること（リークなし） |
| 大量データ表示時 | 過去1年分のインサイト表示 | メモリ使用量が100MB以下であること |
| メモリ制約環境 | 利用可能メモリ制限設定 | 適切なメモリ管理で正常動作すること |
| バックグラウンド処理 | バックグラウンドでのデータ同期 | メモリ使用量が20MB以下であること |
| 画像キャッシュ管理 | 多数の画像を含むコンテンツ閲覧 | メモリキャッシュが適切に管理されること |
| 低メモリ警告対応 | システム低メモリ警告発生 | 適切にメモリを解放し、クラッシュしないこと |

### 4.3 バッテリー消費テスト

| テストケース | テスト条件 | 期待される結果 |
|------------|----------|-------------|
| バックグラウンド分析処理 | 1時間のバックグラウンド実行 | バッテリー消費が5%以下であること |
| データ同期頻度: 高 | 15分ごとの同期設定 | 1時間あたりのバッテリー消費が4%以下 |
| データ同期頻度: 中 | 1時間ごとの同期設定 | 1時間あたりのバッテリー消費が2%以下 |
| データ同期頻度: 低 | 6時間ごとの同期設定 | 1時間あたりのバッテリー消費が1%以下 |
| バッテリー節約モード | システムバッテリー節約モード有効時 | 非必須の同期が一時停止されること |
| CPU使用率 | バックグラウンド処理中 | CPU使用率が5%以下であること |
| ネットワーク使用効率 | データ同期処理 | 効率的なバッチ処理で通信回数最小化 |

## 5. セキュリティテスト

### 5.1 データ保護テスト

| テストケース | テスト条件/方法 | 期待される結果 |
|------------|--------------|-------------|
| ローカルデータ暗号化 | ファイルシステム検査 | 保存された分析データがAES-256で暗号化されている |
| HTTPS通信 | ネットワークトラフィック監視 | すべてのAPI通信がHTTPS経由で行われている |
| 認証トークン保存 | セキュアストレージ検査 | トークンがセキュアストレージに保存されている |
| センシティブデータ保護 | コードレビュー、ログ検査 | センシティブデータがログに出力されていない |
| SQLインジェクション対策 | 悪意あるデータ入力テスト | データベースクエリが適切にパラメータ化されている |
| XSS対策 | 悪意あるHTMLコンテンツテスト | HTMLコンテンツが適切にサニタイズされている |
| データ復号プロセス | セキュアコード監査 | 復号キーの取り扱いが適切に保護されている |

### 5.2 プライバシー設定テスト

| テストケース | テスト条件/方法 | 期待される結果 |
|------------|--------------|-------------|
| オプトアウト設定適用 | 「分析を無効化」オプション有効化 | データ収集が停止され、新しい分析が生成されない |
| 部分的なオプトアウト | 特定分析タイプのオプトアウト | 指定タイプのデータのみ収集停止される |
| 既存データ処理 | オプトアウト後のデータ消去リクエスト | 既存の分析データが適切に削除される |
| 設定リアルタイム反映 | プライバシー設定変更直後にアプリ使用 | 変更が即時に反映されている |
| セッション持続性 | アプリ再起動後 | プライバシー設定が保持されている |
| バックエンド反映 | APIリクエスト監視 | オプトアウト設定がAPIリクエストに反映されている |
| データポータビリティ | データエクスポートリクエスト | すべての分析データが適切なフォーマットでエクスポートされる |

## 6. AI/ML検証テスト

### 6.1 目醒め度評価精度テスト

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| ゴールドスタンダード比較 | 専門家が評価した100サンプルのユーザーデータ | AIとゴールドスタンダードの一致率80%以上、平均誤差10ポイント以内 |
| 時間的安定性評価 | 同一ユーザーデータの7日間隔での再評価（10回） | 変動係数5%以内、不自然な急激な変化がない |
| エッジケーステスト - 極少データ | 最小限のアクティビティデータ | 確定できない場合の適切な処理、信頼度スコア低表示 |
| エッジケーステスト - 矛盾データ | 矛盾する行動パターンを含むデータ | 主要パターンの適切な優先付けと矛盾の説明 |
| バイアス検出 - 活動タイプ | 特定活動に偏ったデータセット | 活動タイプによる不当な評価バイアスがないこと |
| バイアス検出 - 表現方法 | 同一内容で表現方法が異なるデータ | 表現スタイルではなく内容に基づいた評価であること |
| バイアス補正効果 | バイアス補正前後の評価結果比較 | 補正後のバイアス度が50%以上低減していること |

### 6.2 インサイト生成品質テスト

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| ブラインドレビュー評価 | 生成されたインサイト100件を専門家が評価 | 品質スコア平均4.0/5.0以上、低品質（2.0未満）が5%以下 |
| インサイト多様性評価 | 同一ユーザー10名に対する各10件のインサイト | インサイト間の意味的類似度平均値50%以下 |
| ルール準拠率測定 - 肯定的 | 生成されたインサイト200件 | 95%以上が肯定的表現を使用している |
| ルール準拠率測定 - 建設的 | 生成されたインサイト200件 | 90%以上が具体的な成長方向を示している |
| ルール準拠率測定 - 意味 | 生成されたインサイト200件 | 85%以上が意味のある深い洞察を含んでいる |
| 根拠追跡可能性 | インサイトと対応するソースデータ | 80%以上のインサイトが明確なソースデータとの関連を示せる |
| パーソナライゼーション効果 | 異なるプロファイルを持つ20ユーザーのデータ | 同一入力でもユーザープロファイルに応じた異なるインサイトが生成される |

### 6.3 不確実性とランダム性の検証

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| アルゴリズムばらつき範囲測定 | 同一データに対する100回の分析実行 | 核となる洞察の一貫性90%以上、表現のばらつきは許容範囲内 |
| モンテカルロシミュレーション | 乱数シードを変えた1000回の実行 | 結果分布が予測モデルと95%一致、外れ値が5%未満 |
| カオスエンジニアリングテスト | ランダムにノイズを挿入した入力データ | 重要でないノイズに対して堅牢であること |
| 大規模摂動テスト | 入力の一部を大きく変化させたデータ | 変更に関連する結果のみが影響を受け、無関係な部分は安定している |
| 信頼度スコア検証 | 様々な品質の入力データと自己評価スコア | 自己評価スコアと実際の品質評価の相関係数0.7以上 |

### 6.4 フィードバックループ検証

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| フィードバック取込効果 | 特定パターンへのフィードバックと改善トラッキング | 同種パターンへの適用精度が20%以上向上する |
| 継続学習精度改善測定 | 3ヶ月間のフィードバックデータ蓄積 | 月次精度向上率5%以上が維持される |
| 過学習防止効果測定 | 偏ったフィードバックデータを使用したトレーニング | 一般ユーザーへの結果品質低下が発生しない |
| 新パターン識別能力 | トレーニングになかった新しい行動パターン | 75%以上の確率で適切に識別し対応できる |

## 7. 国際化・多言語対応テスト

### 7.1 多言語インサイト生成テスト

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| 日本語インサイト品質 | 日本語ユーザー向けインサイト100件 | ネイティブ評価者による品質スコア4.0/5.0以上 |
| 英語インサイト品質 | 英語ユーザー向けインサイト100件 | ネイティブ評価者による品質スコア4.0/5.0以上 |
| 中国語インサイト品質 | 中国語ユーザー向けインサイト100件 | ネイティブ評価者による品質スコア4.0/5.0以上 |
| 言語間品質一貫性 | 同一内容の多言語インサイト（5言語） | 言語間の品質スコアの変動係数10%以内 |
| 文化的ニュアンス反映 | 文化固有の文脈を含む内容 | 各文化のニュアンスが90%以上適切に反映されている |
| 翻訳vs.ネイティブ生成 | 翻訳版と直接生成版の比較 | ネイティブ生成版が自然さスコアで20%以上優れている |

### 7.2 文化的配慮検証

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| 文化適応性評価 | 異なる文化背景10種に対する分析結果 | 文化的適切性評価スコア4.0/5.0以上 |
| センシティブトピック対応 | 文化的に敏感なテーマに関するデータ | 適切な配慮を示し、不快感を与えない表現が使用されている |
| 地域文脈理解度 | 地域固有の表現や事例を含むデータ | 各地域の文脈に対する理解度スコア80%以上 |
| 価値観ニュートラリティ | 異なる価値観を反映する内容の分析 | バイアス検出ツールでの中立性スコア85%以上 |
| クロスカルチャー適応 | 複数文化の要素を含むコンテンツ | 複合的文化背景の適切な認識と処理 |

### 7.3 国際化UI検証

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| 日本語UI表示 | 日本語ロケール設定での画面表示 | すべてのテキストが正しく表示され、レイアウトが適切 |
| アラビア語UI表示 | アラビア語ロケール設定での画面表示 | 右から左へのレイアウトが正しく適用されている |
| キリル文字UI表示 | ロシア語ロケール設定での画面表示 | キリル文字が正しいフォントで表示されている |
| 日付フォーマット | 各地域設定での日付表示 | 地域の標準フォーマットに従って表示されている |
| 数値フォーマット | 各地域設定での数値表示 | 小数点、千の区切りが地域標準に従っている |
| テキスト拡張対応 | 同じ内容の短い言語と長い言語での表示 | どちらのケースでもレイアウトが崩れない |

## 8. 長期的品質検証テスト

### 8.1 時間経過に伴う精度検証

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| 精度変化トラッキング | 3ヶ月ごとの同一データセット評価 | 精度低下が見られない（または向上している） |
| ユーザー行動変化適応 | 急激な行動パターン変化を含むデータ | 変化後も8週間以内に90%の精度回復 |
| データ蓄積による精度向上 | 利用期間の異なるユーザーグループの比較 | 長期ユーザーの評価精度が15%以上優れている |
| データドリフト検出 | 時系列データの分布変化分析 | ドリフト検出システムが95%以上の精度で変化を特定 |
| モデル劣化予測 | 時間経過によるパフォーマンス指標変化 | 劣化予測が実際の劣化と85%一致する |

### 8.2 持続的フィードバックループテスト

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| フィードバック集約分析 | 6ヶ月分のユーザーフィードバックデータ | 傾向分析が人間の分析結果と90%一致する |
| モデル調整効果測定 | フィードバック前後のモデルパフォーマンス | 調整後のモデルが特定課題で25%以上改善している |
| A/Bテスト有効性 | 同時実行されたA/Bテスト結果分析 | 統計的に有意な結果が得られている（p<0.05） |
| 満足度長期トレンド | 12ヶ月間の満足度調査データ | アップデート後の満足度向上トレンドが確認できる |
| 自己改善メカニズム | システムによる自己調整プロセス | 外部介入なしで問題の80%が修正される |

### 8.3 大規模データ処理の長期安定性

| テストケース | テスト入力/方法 | 期待される結果 |
|------------|--------------|-------------|
| データ量拡大テスト | 2年分のユーザーデータ（100万ユーザー規模） | クエリレスポンス時間が許容範囲内（3秒以内） |
| データアーカイブ効率 | 大量の古いデータのアーカイブと取得 | アーカイブ処理がバックグラウンドで完了し、取得が5秒以内 |
| 異常検出と自動復旧 | 模擬障害の注入（データ破損、接続断） | 99%の異常が検出され、95%が自動復旧する |
| ユーザー増加スケール | ユーザー数を段階的に10倍に増加 | パフォーマンス低下が20%以内に抑えられる |
| 長期データ整合性 | 3年間のデータ整合性チェック | データ不整合が0.1%未満である |

## 9. テスト優先度評価

### 9.1 クリティカル機能テスト（最優先）

| 機能 | テスト項目 | 優先度根拠 |
|-----|----------|----------|
| 目醒め度評価コアアルゴリズム | 精度、安定性、エッジケース | 機能の核心部分、ユーザー体験の基盤 |
| インサイト生成基本精度 | 内容品質、ルール準拠、根拠追跡 | 主要価値提供機能、満足度への直接影響 |
| プライバシー保護メカニズム | データ保護、設定適用、暗号化 | 法的リスク、ユーザー信頼性への影響 |
| 基本UIレンダリング | 表示正確性、操作応答性 | ユーザーインターフェース基本機能 |

### 9.2 高優先度テスト（第2優先）

| 機能 | テスト項目 | 優先度根拠 |
|-----|----------|----------|
| パーソナライゼーション | ユーザー適応性、多様性 | 差別化機能、ユーザー維持率への影響 |
| フィードバックループ | 収集、分析、適用効果 | システム改善の基盤、長期品質向上 |
| エラー処理と復旧 | 異常検出、自動回復、ユーザー通知 | システム安定性、エラー体験 |
| パフォーマンス要件 | レスポンス時間、リソース使用効率 | ユーザー体験の流暢さに直結 |
| 多言語対応コア | 主要言語サポート、基本的な文化適応 | 国際展開の基盤、ユーザーベース拡大 |

## 10. 受け入れテスト

| 項目 | テスト条件/方法 | 合格基準 |
|-----|--------------|-------|
| 単体テスト合格率 | すべての単体テスト実行 | 100%合格 |
| 統合テスト合格率 | すべての統合テスト実行 | 100%合格 |
| UIテスト安定性 | UIテストを10回連続実行 | 10回すべて合格 |
| パフォーマンス要件達成 | レスポンス時間測定 | 目醒め度取得2秒以内、インサイト生成3秒以内 |
| セキュリティ脆弱性 | セキュリティスキャン実行 | 重大な脆弱性がゼロ件 |
| 品質目標達成 | ユーザーフィードバックテスト | 85%以上が「役立つ」と評価 |
| プライバシー要件 | プライバシー設定機能テスト | すべてのプライバシーコントロールが正常に機能 |
| アクセシビリティ準拠 | アクセシビリティスキャン | WCAG 2.1 AAレベルに準拠 |
| コードカバレッジ | カバレッジレポート生成 | 全体カバレッジ80%以上 |
| ドキュメント完全性 | ドキュメントレビュー | すべての機能が適切に文書化されている |
| AI検証メトリクス | AIパフォーマンス評価一式 | 精度、一貫性、バイアスの基準値をすべて満たす |
| 多言語対応 | 対応言語評価 | すべての主要言語で品質基準を満たす |
| 長期安定性 | 継続運用シミュレーション | 1年相当の運用でパフォーマンス低下なし |