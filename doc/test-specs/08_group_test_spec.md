# グループ機能テスト仕様書

## 概要
本ドキュメントは、グループ機能の設計およびTDD（テスト駆動開発）での実装のためのテスト仕様書です。
API、UI、統合テスト、E2Eテストの各レベルでのテスト要件を定義します。

## 1. API単体テスト

### 1.1 グループ作成API (`POST /groups`)

#### 1.1.1 正常系テスト
**テストケース**: 基本的なグループ作成
- **入力**: グループ名、説明、公開設定
- **期待結果**: ステータス201、グループID、作成者情報を含むレスポンス

**テストケース**: プライベートグループ作成
- **入力**: 公開設定=false、招待ユーザーリスト
- **期待結果**: ステータス201、プライベート設定とメンバー情報を含むレスポンス

**テストケース**: グループアイコン付き作成
- **入力**: 基本情報、アイコン画像
- **期待結果**: ステータス201、画像URL情報を含むレスポンス

#### 1.1.2 異常系テスト
**テストケース**: 認証なしでアクセス
- **入力**: 認証トークンなし
- **期待結果**: ステータス401、認証エラーメッセージ

**テストケース**: バリデーションエラー
- **入力**: グループ名なし、または制限文字数超過
- **期待結果**: ステータス400、バリデーションエラーメッセージ

### 1.2 グループ参加API

**テストケース**: 公開グループへの参加
- **入力**: 公開グループID
- **期待結果**: ステータス200、参加確認情報

**テストケース**: 招待コードによる参加
- **入力**: 招待コード
- **期待結果**: ステータス200、グループ情報と参加確認

**テストケース**: 既に参加済みの場合
- **入力**: 参加済みグループID
- **期待結果**: ステータス400、「既に参加しています」メッセージ

**テストケース**: プライベートグループへの不正アクセス
- **入力**: 招待なしのプライベートグループID
- **期待結果**: ステータス403、アクセス拒否メッセージ

### 1.3 グループ管理API

**テストケース**: グループ情報更新
- **入力**: グループID、更新情報
- **期待結果**: ステータス200、更新された情報

**テストケース**: メンバー招待
- **入力**: グループID、招待ユーザーリスト
- **期待結果**: ステータス200、招待結果情報

**テストケース**: メンバー削除
- **入力**: グループID、削除するユーザーID
- **期待結果**: ステータス200、メンバー削除確認

**テストケース**: 管理者権限変更
- **入力**: グループID、ユーザーID、権限レベル
- **期待結果**: ステータス200、権限更新確認

**テストケース**: グループ削除
- **入力**: グループID
- **期待結果**: ステータス200、削除確認メッセージ

### 1.4 グループコンテンツAPI

**テストケース**: グループ投稿一覧取得
- **入力**: グループID、ページネーションパラメータ
- **期待結果**: ステータス200、投稿リスト、ページネーション情報

**テストケース**: グループ内投稿作成
- **入力**: グループID、投稿内容、添付ファイル
- **期待結果**: ステータス201、作成された投稿情報

**テストケース**: イベント作成
- **入力**: グループID、イベント情報
- **期待結果**: ステータス201、イベント詳細情報

## 2. UI単体テスト

### 2.1 グループ一覧コンポーネント

**テストケース**: グループ一覧表示
- **入力**: グループデータ配列
- **期待結果**: 各グループのカードが表示され、名前、メンバー数などが表示される

**テストケース**: グループ作成ボタン表示
- **入力**: 認証済みユーザー
- **期待結果**: グループ作成ボタンが表示され、クリックでモーダル表示

**テストケース**: グループ検索機能
- **入力**: 検索キーワード
- **期待結果**: キーワードに一致するグループのみフィルタリング表示

**テストケース**: タブ切り替え（参加中/おすすめ/管理中）
- **入力**: タブ選択
- **期待結果**: 選択したタブに応じたグループリストが表示される

### 2.2 グループ詳細コンポーネント

**テストケース**: グループ情報表示
- **入力**: グループID
- **期待結果**: グループ名、説明、メンバー数、公開設定などが表示される

**テストケース**: メンバー一覧表示
- **入力**: グループID、メンバーデータ
- **期待結果**: メンバーリストが表示され、管理者が識別できる

**テストケース**: 参加ボタン状態
- **入力**: 未参加グループ
- **期待結果**: 参加ボタンが表示され、クリックで参加APIが呼ばれる

**テストケース**: 管理メニュー表示（管理者向け）
- **入力**: 管理者権限でログイン
- **期待結果**: 設定メニューが表示され、各管理機能にアクセス可能

### 2.3 グループ投稿コンポーネント

**テストケース**: 投稿フォーム表示
- **入力**: グループID、認証済みユーザー
- **期待結果**: 投稿フォームが表示され、テキスト入力と添付機能が利用可能

**テストケース**: 投稿リスト表示
- **入力**: グループID、投稿データ配列
- **期待結果**: 投稿が新しい順に表示され、各投稿の内容、作成者、タイムスタンプが表示される

**テストケース**: 投稿インタラクション
- **入力**: いいね/コメントボタンクリック
- **期待結果**: 対応するアクションが実行され、UI状態が更新される

**テストケース**: 投稿フィルタリング
- **入力**: フィルターオプション選択（すべて/イベント/メディア）
- **期待結果**: 選択したフィルターに一致する投稿のみ表示される

## 3. 統合テスト

### 3.1 グループ作成と参加フロー

**テストケース**: グループ作成から参加までの一連のフロー
- **手順**:
  1. グループ作成画面表示
  2. グループ情報入力
  3. 作成API呼び出し
  4. グループ詳細表示
  5. 招待リンク生成
  6. 別ユーザーでの参加
- **期待結果**: 一連のフローがエラーなく完了する

**テストケース**: 招待プロセス
- **手順**:
  1. 管理者がメンバー招待
  2. 招待通知送信確認
  3. 招待されたユーザーの参加フロー
- **期待結果**: 招待と参加プロセスが正常に機能する

### 3.2 グループコンテンツフロー

**テストケース**: グループ内投稿とインタラクション
- **手順**:
  1. グループ内で投稿作成
  2. 投稿へのコメント
  3. いいね・共有アクション
  4. 通知配信
- **期待結果**: コンテンツと反応の流れが正常に機能する

**テストケース**: グループイベント作成と参加
- **手順**:
  1. グループ内でイベント作成
  2. メンバーへの通知
  3. イベント参加登録
  4. イベント詳細確認
- **期待結果**: イベント関連フローが正常に動作する

## 4. E2Eテスト

### 4.1 グループ作成から投稿までの完全なユーザージャーニー

**テストケース**: 新規ユーザーのグループ体験
- **手順**:
  1. ユーザー登録/ログイン
  2. グループ探索
  3. グループ作成
  4. メンバー招待
  5. 投稿作成
  6. コメントやいいねのインタラクション
  7. 通知受信確認
- **期待結果**: 一連のユーザージャーニーが正常に完了する

### 4.2 グループメンバー管理E2Eテスト

**テストケース**: 管理者によるメンバー管理
- **手順**:
  1. 管理者としてログイン
  2. メンバー招待
  3. 権限変更
  4. メンバー削除
  5. グループ設定変更
- **期待結果**: 管理機能が正常に動作し、変更が反映される

## まとめ

本テスト仕様書は、グループ機能のTDD実装に必要な全てのテストケースを網羅しています。

### テストの優先順位

1. **最優先**: API単体テスト（基本的な機能の動作保証）
2. **高優先**: UI単体テスト（ユーザーインターフェースの正確性）
3. **中優先**: 統合テスト（機能間の連携確認）
4. **低優先**: E2Eテスト（完全なユーザーフローの検証）

### カバレッジ目標

- 単体テスト: 90%以上
- 統合テスト: 80%以上
- E2Eテスト: 主要なユーザーフローを網羅