# 画像投稿機能

## 概要
ユーザーが画像を投稿できる機能を提供します。複数の画像を1つの投稿として共有することができ、レイアウトのカスタマイズも可能です。

## 技術仕様

### 画像フォーマット
- 対応フォーマット: JPEG, PNG, GIF, WebP
- 最大ファイルサイズ: 5MB
- 画像の保存先: Firebase Storage (`images/` ディレクトリ)

### レイアウトオプション
- 1枚表示: 単一の画像を大きく表示
- 3枚表示: 3枚の画像をグリッドレイアウトで表示
- 4枚表示: 4枚の画像を2x2グリッドで表示
- 9枚表示: 9枚の画像を3x3グリッドで表示

### エラーハンドリング
- ファイルサイズ超過: 「ファイルサイズが大きすぎます。5MB以下にしてください。」
- 非対応フォーマット: 「対応していないファイル形式です。JPEG、PNG、GIF、WebPのみ対応しています。」
- アップロード失敗: 「アップロードに失敗しました。もう一度お試しください。」

## UI/UX仕様

### 投稿フロー
1. 「新規投稿を作成」ボタンをクリック
2. 「動画・画像」オプションを選択
3. レイアウトを選択（1枚、3枚、4枚、9枚）
4. 画像を選択（ドラッグ&ドロップまたはファイル選択）
5. プレビューを確認
6. 説明文を入力（任意）
7. 「投稿する」ボタンをクリック

### ローディング状態
- アップロード中は「投稿する」ボタンが無効化
- ボタンのテキストが「投稿中...」に変更
- アップロード完了後に自動的にホーム画面に遷移

## セキュリティ

### Firebase Storageのセキュリティルール
```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /images/{imageId} {
      allow read: if true;
      allow write: if request.auth != null
                   && request.resource.size <= 5 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }
  }
}
```

## 実装の注意点
- 画像アップロード前にクライアントサイドでバリデーションを実施
- エラーメッセージは全て日本語で表示
- アップロード失敗時は適切なエラーメッセージを表示し、再試行可能な状態を維持
- 未使用の画像URLはメモリリークを防ぐためにURL.revokeObjectURLで解放
