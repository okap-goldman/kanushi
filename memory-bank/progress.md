# 進捗状況

## 実装済み機能

### ユーザー管理機能

#### アカウント作成/ログイン
- [x] Google OAuth 2.0による認証
  - Firebase Authenticationを使用した実装
  - Googleプロバイダーによるポップアップ認証
  - ユーザー情報の自動同期
- [x] UI実装
  - ログイン/サインアップ画面のGoogleログインボタン
  - 利用規約・プライバシーポリシーへの同意チェック
  - エラーメッセージ表示
- [x] 認証状態管理
  - AuthContextによるグローバルな状態管理
  - Firebaseの認証状態監視（onAuthStateChanged）
  - PrivateRouteによるルート保護
  - ローディング状態の表示

#### プロフィール設定
- [x] プロフィール情報の編集
  - API: Firebase Firestoreを使用
  - データベーススキーマ: `USERS`テーブル実装済み
  - UI: プロフィール編集モーダル
  - 開発環境対応: モックユーザー対応

#### 通知設定
- [ ] 通知設定の管理
  - API: 仕様定義のみ
  - データベーススキーマ: `NOTIFICATIONS`テーブル定義のみ
  - UI: 実装済み（通知設定画面）
  - FCM: 未実装

### フォロー機能

#### ファミリー/ウォッチ
- [x] フォロー機能の基本実装
  - API: テスト実装完了
    - POST /follows: ファミリー/ウォッチフォロー作成
    - DELETE /follows/{follow_id}: アンフォロー
    - GET /users/{user_id}/followers: フォロワー一覧取得
    - GET /users/{user_id}/following: フォロー一覧取得
  - データベーススキーマ: `FOLLOWS`テーブル定義のみ
  - UI: 実装済み（フォローボタンとフォロー理由入力UI）

### タイムライン機能

#### 投稿機能
- [x] 動画投稿
  - API: フロントエンドとバックエンドの統合完了、基本的な動画投稿APIの実装
  - YouTube API連携: 基本的な統合実装（プレースホルダー）
  - UI: 実装済み（VideoPostFormコンポーネント、録画インターフェース、動画プレビュー）
  - CreatePostDialogにタブとして追加済み
- [ ] 画像投稿
  - API: 未実装
  - Box連携: 未実装
  - UI: 未実装
- [ ] 音声投稿
  - API: 未実装
  - PodBean API連携: 未実装
  - UI: 未実装
- [ ] テキスト投稿
  - API: 未実装
  - UI: 未実装

#### インタラクション機能
- [ ] いいね機能
  - API: 未実装
  - データベーススキーマ: `LIKES`テーブル定義のみ
  - UI: 実装済み（いいねボタン、アニメーション）
- [ ] コメント機能
  - API: 未実装
  - データベーススキーマ: `COMMENTS`テーブル定義のみ
  - UI: 実装済み（コメント入力UI、コメント一覧表示）
- [ ] ハイライト機能
  - API: 未実装
  - データベーススキーマ: `HIGHLIGHTS`テーブル定義のみ
  - UI: 実装済み（ハイライトボタン、理由入力UI）

#### ストーリー機能
- [ ] ストーリー投稿/表示
  - API: 仕様定義のみ
  - データベーススキーマ: `STORIES`テーブル定義のみ
  - UI: 実装済み（ストーリー投稿UI、ストーリー表示UI）

### プロフィール機能

#### プロフィール表示
- [ ] 基本情報表示
  - API: 仕様定義のみ
  - UI: 実装済み（プロフィールページのレイアウト）
- [ ] 投稿タブ表示
  - API: 仕様定義のみ
  - UI: 実装済み（メディア、音声、テキスト、ハイライト、イベントの各タブ）
- [ ] フォロワー数表示
  - API: 仕様定義のみ
  - UI: 実装済み（ファミリー/ウォッチ数の表示）

### 検索・AIチャット機能

#### 検索機能
- [ ] キーワード検索
  - API仕様のみ定義済み
  - 実装未着手

#### AIチャット
- [ ] DeepSeek R1連携
  - API仕様のみ定義済み
  - 実装未着手
- [ ] 質問制限機能
  - 仕様定義のみ
  - 実装未着手

### イベント機能

#### イベント管理
- [ ] イベント登録/参加
  - API: 仕様定義のみ
  - データベーススキーマ: `EVENTS`, `EVENTPARTICIPANTS`テーブル定義のみ
  - UI: 実装済み（イベント登録フォーム、参加フォーム）
- [ ] Stripe決済連携
  - API: 仕様定義のみ
  - データベーススキーマ: `TRANSACTIONS`テーブル定義のみ
  - UI: 実装済み（決済フロー）
  - Stripe連携: 未実装

### 発見（Discovery）機能

#### 分析・表示機能
- [ ] ユーザー分析
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] 地域活動表示
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] おすすめ投稿
  - API: 仕様定義のみ
  - UI: 未実装

### ショップ機能

#### 商品管理
- [ ] 商品一覧/詳細
  - API: 仕様定義のみ
  - データベーススキーマ: `SHOPS`, `PRODUCTS`テーブル定義のみ
  - UI: 実装済み（商品一覧、詳細表示）
- [ ] 取引管理
  - API: 仕様定義のみ
  - データベーススキーマ: `TRANSACTIONS`テーブル定義のみ
  - UI: 実装済み（取引履歴、管理画面）
  - Stripe連携: 未実装

### 管理者機能

#### モデレーション機能
- [ ] ユーザー管理
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] 投稿管理
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] イベント管理
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] ショップ管理
  - API: 仕様定義のみ
  - UI: 未実装
- [ ] AIチャットログ監視
  - API: 仕様定義のみ
  - UI: 未実装

## 実装中の機能

現在、以下の機能の実装に取り組んでいます：

1. **投稿機能の拡張**
   - 画像投稿機能の実装
   - 音声投稿機能の実装
   - YouTubeとの連携の強化
   - 投稿時のメタデータ処理

2. **プロフィールページのメディア表示**
   - カスタムタイルレイアウト
   - 動画/画像の表示最適化

3. **ショップ機能**
   - 商品一覧/詳細表示
   - Stripe決済連携

## 今後の実装予定

### 短期（1-2週間）
1. 動画投稿機能の完成
2. 画像投稿機能の完成
3. プロフィールページのメディア表示

### 中期（3-4週間）
1. ショップ機能の実装
2. イベント機能の実装
3. AIチャット機能の実装

### 長期（リリースまで）
1. React Native + Expoへの移行
2. 発見機能の実装
3. 管理者機能の実装

## 既知の問題

1. **YouTube連携の審査リスク**
   - 問題: アプリ審査でYouTube連携が承認されない可能性
   - 優先度: 高
   - 対応策: 早期検証、代替手段の検討

2. **パフォーマンスの最適化**
   - 問題: メディアコンテンツ（画像、動画、音声）の読み込み最適化
   - 優先度: 中
   - 対応策: CDN活用、キャッシュ戦略、遅延読み込み

3. **モバイル対応**
   - 問題: 現在のWebアプリからReact Native + Expoへの移行
   - 優先度: 中
   - 対応策: 段階的な移行、互換性テスト

4. **外部サービス依存**
   - 問題: YouTube、Box、PodBeanなど外部サービスへの依存
   - 優先度: 中
   - 対応策: フォールバックメカニズム、サービス変更への対応計画

## 技術的負債

1. **コードの再利用性**
   - 問題: 一部のコンポーネントが特定のコンテキストに強く依存
   - 対応策: コンポーネントの抽象化、共通インターフェースの定義

2. **型定義の不足**
   - 問題: 一部のコードで型定義が不十分
   - 対応策: TypeScriptの型定義の強化、インターフェースの整備

3. **テストカバレッジ**
   - 問題: 単体テスト、統合テストの不足
   - 対応策: テスト戦略の策定、重要コンポーネントのテスト優先実装

4. **ドキュメント不足**
   - 問題: コードドキュメントの不足
   - 対応策: JSDoc形式のコメント追加、README更新

## 次のマイルストーン

### マイルストーン1: 投稿機能の完成（目標: 2週間以内）
- テキスト投稿機能
- 画像投稿機能
- 動画投稿機能
- 音声投稿機能

### マイルストーン2: プロフィール・タイムライン機能の強化（目標: 4週間以内）
- プロフィールページのメディア表示
- タイムライン表示の最適化
- いいね/コメント/ハイライト機能

### マイルストーン3: ショップ・イベント機能（目標: 6週間以内）
- ショップ機能
- イベント機能
- Stripe決済連携

### マイルストーン4: アプリ審査準備（目標: 8週間以内）
- React Native + Expo移行
- パフォーマンス最適化
- アプリ審査対応

## 開発メトリクス

- **開発速度**: 現在の開発速度では、コア機能（投稿、プロフィール、タイムライン）の実装に約4週間必要
- **バグ率**: 現時点では正式なバグトラッキングは未実施
- **テストカバレッジ**: 現在のテストカバレッジは低い（約10%程度）
- **コードの品質**: ESLintとTypeScriptの型チェックを活用中

## 今後の課題

1. **スケーリング**
   - ユーザー数増加に伴うパフォーマンス対策
   - CDN、キャッシュサーバーの活用

2. **セキュリティ**
   - 認証・認可の強化
   - データ保護対策
   - 外部サービス連携のセキュリティ

3. **ユーザーエクスペリエンス**
   - UI/UXの継続的改善
   - フィードバックに基づく機能改善

4. **モバイル最適化**
   - React Native + Expoへの移行
   - モバイル固有機能の活用

### 開発環境の整備

#### フロントエンドとバックエンドの統合
- [x] API サーバーの実装
  - Express サーバーの設定
  - APIルートの実装
  - コントローラーの実装
- [x] フロントエンドとの統合
  - Viteフロントエンドとの連携
  - 同一ポート(4488)での実行
  - npm run devコマンドによる統合サーバー起動
- [x] npm run devエラーの修正
  - TypeScriptファイル拡張子のESMモード対応（tsx使用）
  - process.envをimport.meta.envに置き換え（Vite互換）
  - Supabase環境変数の設定
  - APIエンドポイントの正常動作確認
